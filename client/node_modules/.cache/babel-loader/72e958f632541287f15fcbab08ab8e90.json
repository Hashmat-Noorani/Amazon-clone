{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport { STATUS } from \"../utils/enums\";\nimport { db } from \"../db/firebase\"; // import {\n//   doc,\n//   setDoc,\n//   getDoc,\n//   getDocs,\n//   deleteDoc,\n//   collection,\n// } from \"firebase/firestore\";\n\nimport { fetchCartItems } from \"./cartSlice\";\nconst savedItemsSlice = createSlice({\n  name: \"savedItems\",\n  initialState: {\n    savedItems: [],\n    status: STATUS.IDLE\n  },\n  reducers: {\n    setsavedItems: (state, action) => ({ ...state,\n      savedItems: action.payload\n    }),\n    setStatus: (state, action) => ({ ...state,\n      status: action.payload\n    })\n  }\n});\nexport const {\n  setsavedItems,\n  setStatus\n} = savedItemsSlice.actions;\nexport default savedItemsSlice.reducer;\nconst savedItemsColl = collection(db, \"saveditems\");\nexport const fetchSavedItems = () => {\n  return function fetchSavedItemsThunk(dispatch) {\n    dispatch(setStatus(STATUS.LOADING));\n    getDocs(savedItemsColl).then(snapshot => {\n      const payload = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      dispatch(setsavedItems(payload));\n      dispatch(setStatus(STATUS.IDLE));\n    }).catch(() => dispatch(setStatus(STATUS.ERROR)));\n  };\n};\nexport const saveForLater = _ref => {\n  let {\n    id,\n    title,\n    price,\n    image\n  } = _ref;\n  return dispatch => {\n    const cartItemDoc = doc(db, \"cartitems\", id);\n    dispatch(setStatus(STATUS.LOADING));\n    deleteDoc(cartItemDoc).then(() => {\n      dispatch(fetchCartItems());\n      const savedItemDoc = doc(db, \"saveditems\", id);\n      getDoc(savedItemDoc).then(docSnap => {\n        if (!docSnap.exists()) {\n          setDoc(doc(savedItemsColl, id), {\n            title,\n            price,\n            image\n          });\n          dispatch(fetchSavedItems());\n        }\n      });\n    }).catch(() => dispatch(setStatus(STATUS.ERROR)));\n  };\n};","map":{"version":3,"names":["createSlice","STATUS","db","fetchCartItems","savedItemsSlice","name","initialState","savedItems","status","IDLE","reducers","setsavedItems","state","action","payload","setStatus","actions","reducer","savedItemsColl","collection","fetchSavedItems","fetchSavedItemsThunk","dispatch","LOADING","getDocs","then","snapshot","docs","map","doc","id","data","catch","ERROR","saveForLater","title","price","image","cartItemDoc","deleteDoc","savedItemDoc","getDoc","docSnap","exists","setDoc"],"sources":["D:/EDU/PROJECTS/Clones/amazon-clone/client/src/redux/savedItemsSlice.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\nimport { STATUS } from \"../utils/enums\";\r\nimport { db } from \"../db/firebase\";\r\n// import {\r\n//   doc,\r\n//   setDoc,\r\n//   getDoc,\r\n//   getDocs,\r\n//   deleteDoc,\r\n//   collection,\r\n// } from \"firebase/firestore\";\r\nimport { fetchCartItems } from \"./cartSlice\";\r\n\r\nconst savedItemsSlice = createSlice({\r\n  name: \"savedItems\",\r\n  initialState: {\r\n    savedItems: [],\r\n    status: STATUS.IDLE,\r\n  },\r\n  reducers: {\r\n    setsavedItems: (state, action) => ({\r\n      ...state,\r\n      savedItems: action.payload,\r\n    }),\r\n\r\n    setStatus: (state, action) => ({\r\n      ...state,\r\n      status: action.payload,\r\n    }),\r\n  },\r\n});\r\n\r\nexport const { setsavedItems, setStatus } = savedItemsSlice.actions;\r\n\r\nexport default savedItemsSlice.reducer;\r\n\r\nconst savedItemsColl = collection(db, \"saveditems\");\r\n\r\nexport const fetchSavedItems = () => {\r\n  return function fetchSavedItemsThunk(dispatch) {\r\n    dispatch(setStatus(STATUS.LOADING));\r\n    getDocs(savedItemsColl)\r\n      .then((snapshot) => {\r\n        const payload = snapshot.docs.map((doc) => ({\r\n          id: doc.id,\r\n          ...doc.data(),\r\n        }));\r\n        dispatch(setsavedItems(payload));\r\n        dispatch(setStatus(STATUS.IDLE));\r\n      })\r\n      .catch(() => dispatch(setStatus(STATUS.ERROR)));\r\n  };\r\n};\r\n\r\nexport const saveForLater =\r\n  ({ id, title, price, image }) =>\r\n  (dispatch) => {\r\n    const cartItemDoc = doc(db, \"cartitems\", id);\r\n    dispatch(setStatus(STATUS.LOADING));\r\n    deleteDoc(cartItemDoc)\r\n      .then(() => {\r\n        dispatch(fetchCartItems());\r\n        const savedItemDoc = doc(db, \"saveditems\", id);\r\n        getDoc(savedItemDoc).then((docSnap) => {\r\n          if (!docSnap.exists()) {\r\n            setDoc(doc(savedItemsColl, id), {\r\n              title,\r\n              price,\r\n              image,\r\n            });\r\n            dispatch(fetchSavedItems());\r\n          }\r\n        });\r\n      })\r\n      .catch(() => dispatch(setStatus(STATUS.ERROR)));\r\n  };\r\n"],"mappings":"AAAA,SAASA,WAAT,QAA4B,kBAA5B;AACA,SAASC,MAAT,QAAuB,gBAAvB;AACA,SAASC,EAAT,QAAmB,gBAAnB,C,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,cAAT,QAA+B,aAA/B;AAEA,MAAMC,eAAe,GAAGJ,WAAW,CAAC;EAClCK,IAAI,EAAE,YAD4B;EAElCC,YAAY,EAAE;IACZC,UAAU,EAAE,EADA;IAEZC,MAAM,EAAEP,MAAM,CAACQ;EAFH,CAFoB;EAMlCC,QAAQ,EAAE;IACRC,aAAa,EAAE,CAACC,KAAD,EAAQC,MAAR,MAAoB,EACjC,GAAGD,KAD8B;MAEjCL,UAAU,EAAEM,MAAM,CAACC;IAFc,CAApB,CADP;IAMRC,SAAS,EAAE,CAACH,KAAD,EAAQC,MAAR,MAAoB,EAC7B,GAAGD,KAD0B;MAE7BJ,MAAM,EAAEK,MAAM,CAACC;IAFc,CAApB;EANH;AANwB,CAAD,CAAnC;AAmBA,OAAO,MAAM;EAAEH,aAAF;EAAiBI;AAAjB,IAA+BX,eAAe,CAACY,OAArD;AAEP,eAAeZ,eAAe,CAACa,OAA/B;AAEA,MAAMC,cAAc,GAAGC,UAAU,CAACjB,EAAD,EAAK,YAAL,CAAjC;AAEA,OAAO,MAAMkB,eAAe,GAAG,MAAM;EACnC,OAAO,SAASC,oBAAT,CAA8BC,QAA9B,EAAwC;IAC7CA,QAAQ,CAACP,SAAS,CAACd,MAAM,CAACsB,OAAR,CAAV,CAAR;IACAC,OAAO,CAACN,cAAD,CAAP,CACGO,IADH,CACSC,QAAD,IAAc;MAClB,MAAMZ,OAAO,GAAGY,QAAQ,CAACC,IAAT,CAAcC,GAAd,CAAmBC,GAAD,KAAU;QAC1CC,EAAE,EAAED,GAAG,CAACC,EADkC;QAE1C,GAAGD,GAAG,CAACE,IAAJ;MAFuC,CAAV,CAAlB,CAAhB;MAIAT,QAAQ,CAACX,aAAa,CAACG,OAAD,CAAd,CAAR;MACAQ,QAAQ,CAACP,SAAS,CAACd,MAAM,CAACQ,IAAR,CAAV,CAAR;IACD,CARH,EASGuB,KATH,CASS,MAAMV,QAAQ,CAACP,SAAS,CAACd,MAAM,CAACgC,KAAR,CAAV,CATvB;EAUD,CAZD;AAaD,CAdM;AAgBP,OAAO,MAAMC,YAAY,GACvB;EAAA,IAAC;IAAEJ,EAAF;IAAMK,KAAN;IAAaC,KAAb;IAAoBC;EAApB,CAAD;EAAA,OACCf,QAAD,IAAc;IACZ,MAAMgB,WAAW,GAAGT,GAAG,CAAC3B,EAAD,EAAK,WAAL,EAAkB4B,EAAlB,CAAvB;IACAR,QAAQ,CAACP,SAAS,CAACd,MAAM,CAACsB,OAAR,CAAV,CAAR;IACAgB,SAAS,CAACD,WAAD,CAAT,CACGb,IADH,CACQ,MAAM;MACVH,QAAQ,CAACnB,cAAc,EAAf,CAAR;MACA,MAAMqC,YAAY,GAAGX,GAAG,CAAC3B,EAAD,EAAK,YAAL,EAAmB4B,EAAnB,CAAxB;MACAW,MAAM,CAACD,YAAD,CAAN,CAAqBf,IAArB,CAA2BiB,OAAD,IAAa;QACrC,IAAI,CAACA,OAAO,CAACC,MAAR,EAAL,EAAuB;UACrBC,MAAM,CAACf,GAAG,CAACX,cAAD,EAAiBY,EAAjB,CAAJ,EAA0B;YAC9BK,KAD8B;YAE9BC,KAF8B;YAG9BC;UAH8B,CAA1B,CAAN;UAKAf,QAAQ,CAACF,eAAe,EAAhB,CAAR;QACD;MACF,CATD;IAUD,CAdH,EAeGY,KAfH,CAeS,MAAMV,QAAQ,CAACP,SAAS,CAACd,MAAM,CAACgC,KAAR,CAAV,CAfvB;EAgBD,CApBD;AAAA,CADK"},"metadata":{},"sourceType":"module"}