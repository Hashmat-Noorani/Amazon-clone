{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport { STATUS } from \"../utils/enums\";\nimport { db } from \"../db/firebase\";\nimport { doc, setDoc, getDoc, getDocs, deleteDoc, collection } from \"firebase/firestore\";\nimport { fetchCartItems } from \"./cartSlice\";\nconst savedItemsSlice = createSlice({\n  name: \"savedItems\",\n  initialState: {\n    savedItems: [],\n    status: STATUS.IDLE\n  },\n  reducers: {\n    setsavedItems: (state, action) => ({ ...state,\n      savedItems: action.payload\n    }),\n    setStatus: (state, action) => ({ ...state,\n      status: action.payload\n    })\n  }\n});\nexport const {\n  setsavedItems,\n  setStatus\n} = savedItemsSlice.actions;\nexport default savedItemsSlice.reducer;\nconst savedItemsColl = collection(db, \"saveditems\");\nexport const fetchSavedItems = () => {\n  return function fetchSavedItemsThunk(dispatch) {\n    dispatch(setStatus(STATUS.LOADING));\n    getDocs(savedItemsColl).then(snapshot => {\n      const payload = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      dispatch(setsavedItems(payload));\n      dispatch(setStatus(STATUS.IDLE));\n    }).catch(() => dispatch(setStatus(STATUS.ERROR)));\n  };\n};\nexport const saveForLater = _ref => {\n  let {\n    id,\n    title,\n    price,\n    image\n  } = _ref;\n  return dispatch => {\n    const cartItemDoc = doc(db, \"cartitems\", id);\n    dispatch(setStatus(STATUS.LOADING));\n    deleteDoc(cartItemDoc).then(() => {\n      dispatch(fetchCartItems());\n      const savedItemDoc = doc(db, \"saveditems\", id);\n      getDoc(savedItemDoc).then(docSnap => {\n        if (!docSnap.exists()) {\n          setDoc(doc(savedItemsColl, id), {\n            title,\n            price,\n            image\n          });\n          dispatch(fetchSavedItems());\n        }\n      });\n    }).catch(() => dispatch(setStatus(STATUS.ERROR)));\n  };\n};","map":{"version":3,"names":["createSlice","STATUS","db","doc","setDoc","getDoc","getDocs","deleteDoc","collection","fetchCartItems","savedItemsSlice","name","initialState","savedItems","status","IDLE","reducers","setsavedItems","state","action","payload","setStatus","actions","reducer","savedItemsColl","fetchSavedItems","fetchSavedItemsThunk","dispatch","LOADING","then","snapshot","docs","map","id","data","catch","ERROR","saveForLater","title","price","image","cartItemDoc","savedItemDoc","docSnap","exists"],"sources":["D:/EDU/PROJECTS/Clones/amazon-clone/client/src/redux/savedItemsSlice.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\nimport { STATUS } from \"../utils/enums\";\r\nimport { db } from \"../db/firebase\";\r\nimport {\r\n  doc,\r\n  setDoc,\r\n  getDoc,\r\n  getDocs,\r\n  deleteDoc,\r\n  collection,\r\n} from \"firebase/firestore\";\r\nimport { fetchCartItems } from \"./cartSlice\";\r\n\r\nconst savedItemsSlice = createSlice({\r\n  name: \"savedItems\",\r\n  initialState: {\r\n    savedItems: [],\r\n    status: STATUS.IDLE,\r\n  },\r\n  reducers: {\r\n    setsavedItems: (state, action) => ({\r\n      ...state,\r\n      savedItems: action.payload,\r\n    }),\r\n\r\n    setStatus: (state, action) => ({\r\n      ...state,\r\n      status: action.payload,\r\n    }),\r\n  },\r\n});\r\n\r\nexport const { setsavedItems, setStatus } = savedItemsSlice.actions;\r\n\r\nexport default savedItemsSlice.reducer;\r\n\r\nconst savedItemsColl = collection(db, \"saveditems\");\r\n\r\nexport const fetchSavedItems = () => {\r\n  return function fetchSavedItemsThunk(dispatch) {\r\n    dispatch(setStatus(STATUS.LOADING));\r\n    getDocs(savedItemsColl)\r\n      .then((snapshot) => {\r\n        const payload = snapshot.docs.map((doc) => ({\r\n          id: doc.id,\r\n          ...doc.data(),\r\n        }));\r\n        dispatch(setsavedItems(payload));\r\n        dispatch(setStatus(STATUS.IDLE));\r\n      })\r\n      .catch(() => dispatch(setStatus(STATUS.ERROR)));\r\n  };\r\n};\r\n\r\nexport const saveForLater =\r\n  ({ id, title, price, image }) =>\r\n  (dispatch) => {\r\n    const cartItemDoc = doc(db, \"cartitems\", id);\r\n    dispatch(setStatus(STATUS.LOADING));\r\n    deleteDoc(cartItemDoc)\r\n      .then(() => {\r\n        dispatch(fetchCartItems());\r\n        const savedItemDoc = doc(db, \"saveditems\", id);\r\n        getDoc(savedItemDoc).then((docSnap) => {\r\n          if (!docSnap.exists()) {\r\n            setDoc(doc(savedItemsColl, id), {\r\n              title,\r\n              price,\r\n              image,\r\n            });\r\n            dispatch(fetchSavedItems());\r\n          }\r\n        });\r\n      })\r\n      .catch(() => dispatch(setStatus(STATUS.ERROR)));\r\n  };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}